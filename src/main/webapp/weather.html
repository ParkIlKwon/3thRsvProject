<!DOCTYPE html>
<html>
<head>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
<meta charset="EUC-KR">
<title>Insert title here</title>
</head>
<script type="text/javascript">
let latitude = 0;
let longitude = 0;
let mykey = 'c8229e9ee7fcc34e489e7670c13c19df';

window.onload = function() {
		
    getUserLocation();

    function getUserLocation() {
        if (!navigator.geolocation) {
            throw "위치 정보가 지원되지 않습니다.";
        }
        navigator.geolocation.getCurrentPosition(function(position) {
        	latitude = position.coords.latitude;
        	longitude = position.coords.longitude;
        	getweather();
		});
    }
    
   function getweather() {
    	$.ajax({
    		type: "GET",
    		url: `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${mykey}`,
    		success: function(response){
    		console.log(response);
    		let temp = Math.floor(response.main.temp - 273.15);
    		let city = response.name;
    		
    		var imgURL = "http://openweathermap.org/img/w/" + response.weather[0].icon + ".png";
    		
     		let result = `<div>오늘의 날씨<br><img src="${imgURL}"><br>
                			지역: ${city}<br>
                			온도: ${temp}℃</div>`;
    		
    		$('body').append(result);
    		}
    	})
	}
}

</script>

<body>
	
</body>
</html>